# Skills (스킬)

번역 에이전트의 전문 지식과 워크플로우를 정의하는 스킬 패키지입니다.

> **참고**: 스킬은 Claude의 능력을 확장하는 모듈식 지식 패키지입니다.
> 각 스킬은 특정 도메인의 전문 지식, 평가 기준, 출력 형식을 포함합니다.

## 개요

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           SKILL 구조                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  │
│   │ Translator  │    │  Accuracy   │    │ Compliance  │    │  Quality    │  │
│   │   Skill     │    │  Evaluator  │    │  Evaluator  │    │  Evaluator  │  │
│   │             │    │   Skill     │    │   Skill     │    │   Skill     │  │
│   │  [Opus]     │    │  [Opus]     │    │  [Opus]     │    │  [Opus]     │  │
│   └──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘  │
│          │                  │                  │                  │         │
│          │                  └────────┬─────────┘                  │         │
│          │                           │                            │         │
│          ▼                           ▼                            ▼         │
│   ┌─────────────┐           ┌─────────────────┐           ┌─────────────┐   │
│   │   번역 생성   │           │   3개 평가 병렬    │           │  품질 판정   │   │
│   │             │──────────▶│   실행           │──────────▶│            │   │
│   │  한국어→영어  │           │  정확성/준수/품질  │           │ Pass/Fail  │   │
│   └─────────────┘           └─────────────────┘           └─────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 디렉토리 구조

```
skills/
├── README.md                      # 이 문서
├── translator/
│   ├── SKILL.md                   # 번역 스킬 정의
│   └── references/                # 참조 문서 (스타일 가이드 등)
├── accuracy-evaluator/
│   ├── SKILL.md                   # 정확성 평가 스킬 정의
│   └── references/                # 점수별 예시, 포맷 패턴
├── compliance-evaluator/
│   ├── SKILL.md                   # 컴플라이언스 평가 스킬 정의
│   └── references/                # 국가별 프로파일, 금칙어
└── quality-evaluator/
    ├── SKILL.md                   # 품질 평가 스킬 정의
    └── references/                # 로케일별 가이드라인
```

---

## 스킬 상세

### 1. Translator (번역 스킬)

**파일**: `translator/SKILL.md`

**모델**: Claude Opus 4.5 (고품질 번역)

**목적**: ABC 클라우드 FAQ 콘텐츠를 한국어에서 대상 언어로 번역

```
┌─────────────────────────────────────────────────────────────────┐
│                      Translator Skill                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  입력                          처리                    출력      │
│  ┌──────────┐                                      ┌──────────┐ │
│  │ 원문     │     ┌─────────────────────────┐      │ 번역문   │ │
│  │ 용어집   │────▶│ 1. 용어집 적용          │─────▶│ 적용용어 │ │
│  │ 스타일   │     │ 2. 포맷 보존            │      │ 비고     │ │
│  └──────────┘     │ 3. 문화적 적응          │      └──────────┘ │
│                   └─────────────────────────┘                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**핵심 기능**:

| 기능 | 설명 |
|------|------|
| **용어집 적용** | 브랜드명, 제품명, 기술 용어를 일관되게 번역 |
| **포맷 보존** | HTML 태그, 플레이스홀더 (`{0}`, `%s`) 유지 |
| **문화적 적응** | 대상 로케일에 맞는 표현, 격식 수준 조정 |
| **다중 후보** | 2개 번역 후보 생성 (품질 비교용) |

**주요 섹션**:
- `<role>`: ABC 클라우드 전문 번역가
- `<glossary_application>`: 용어집 적용 규칙
- `<locale_guidelines>`: 언어별 스타일 가이드 (en-rUS, ja, zh-rCN 등)
- `<format_preservation>`: HTML/플레이스홀더 보존 규칙

---

### 2. Accuracy Evaluator (정확성 평가 스킬)

**파일**: `accuracy-evaluator/SKILL.md`

**모델**: Claude Opus 4.5

**목적**: 번역의 의미 정확성, 용어 준수, 포맷 무결성 평가

```
┌─────────────────────────────────────────────────────────────────┐
│                   Accuracy Evaluator Skill                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  평가 요소                      가중치                           │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                             │ │
│  │  의미 정확성 (Semantic)                          50%       │ │
│  │  ├─ 원문 vs 역번역 비교                                    │ │
│  │  ├─ 의미 손실/추가/왜곡 감지                               │ │
│  │  └─ 뉘앙스 변화 확인                                       │ │
│  │                                                             │ │
│  │  용어 준수 (Terminology)                         30%       │ │
│  │  ├─ 용어집 매핑 확인                                       │ │
│  │  ├─ 브랜드명 정확성                                        │ │
│  │  └─ 대체 표현 사용 여부                                    │ │
│  │                                                             │ │
│  │  포맷 무결성 (Format)                            20%       │ │
│  │  ├─ HTML 태그 보존                                         │ │
│  │  ├─ 플레이스홀더 유지                                      │ │
│  │  └─ 숫자/날짜/단위 형식                                    │ │
│  │                                                             │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**점수 기준 (0-5점)**:

| 점수 | 판정 | 설명 |
|------|------|------|
| **5점** | Pass | 의미/용어/포맷 완벽 |
| **4점** | Pass | 경미한 뉘앙스 차이, 수정 선택적 |
| **3점** | Review | 일부 의미 손실, PM 검수 필요 |
| **2점** | Fail | 의미 왜곡, 용어 다수 오류 |
| **1점** | Fail | 심각한 오역, 의미 반전 |
| **0점** | Fail | 원문과 무관한 내용 |

**Chain-of-Thought**:
```
Step 1 (Semantic): 역번역과 원문 비교 → 의미 일치도 분석
Step 2 (Terminology): 용어집 항목별 적용 확인
Step 3 (Format): HTML/플레이스홀더 보존 확인
```

---

### 3. Compliance Evaluator (컴플라이언스 평가 스킬)

**파일**: `compliance-evaluator/SKILL.md`

**모델**: Claude Opus 4.5

**목적**: 법률, 규제, 콘텐츠 안전 준수 여부 평가

```
┌─────────────────────────────────────────────────────────────────┐
│                  Compliance Evaluator Skill                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  리스크 프로파일 기반 평가                                        │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                             │ │
│  │  금칙어 검사 (Prohibited Terms)                   30%      │ │
│  │  ├─ "guaranteed" → 보증 암시 (고위험)                      │ │
│  │  ├─ "free forever" → 허위광고 위험 (고위험)                │ │
│  │  └─ "100% safe" → 절대적 주장 (고위험)                     │ │
│  │                                                             │ │
│  │  필수 면책문구 (Required Disclaimers)             25%      │ │
│  │  ├─ 데이터 삭제 고지                                       │ │
│  │  ├─ 구독 취소 안내                                         │ │
│  │  └─ 책임 제한 문구                                         │ │
│  │                                                             │ │
│  │  콘텐츠 안전 (Content Safety)                     25%      │ │
│  │  ├─ 오해의 소지 있는 표현                                  │ │
│  │  ├─ 유해 콘텐츠                                            │ │
│  │  └─ 문화적 부적절 요소                                     │ │
│  │                                                             │ │
│  │  규제 정합성 (Regulatory)                         20%      │ │
│  │  ├─ GDPR (EU)                                              │ │
│  │  ├─ CCPA (US-CA)                                           │ │
│  │  └─ 현지 법규                                              │ │
│  │                                                             │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**리스크 프로파일 구조**:
```yaml
region: US
prohibited_terms:
  - term: "guaranteed"
    severity: high
    reason: "법적 보증 암시"
required_disclaimers:
  - context: "data_deletion"
    text: "Once deleted, data cannot be recovered."
```

**점수 기준 (0-5점)**:

| 점수 | 판정 | 설명 |
|------|------|------|
| **5점** | Pass | 완전 준수, 발행 가능 |
| **4점** | Pass | 준수, 경미한 권고사항 |
| **3점** | Review | 그레이 영역, 법무팀 검토 필요 |
| **2점** | Fail | 컴플라이언스 이슈, 수정 필수 |
| **1점** | Fail | 심각한 위반, 법무팀 에스컬레이션 |
| **0점** | Fail | 다중 고위험 위반, 발행 불가 |

---

### 4. Quality Evaluator (품질 평가 스킬)

**파일**: `quality-evaluator/SKILL.md`

**모델**: Claude Opus 4.5 (고품질 판단)

**목적**: 번역의 자연스러움, 톤/격식, 문화적 적합성 평가

```
┌─────────────────────────────────────────────────────────────────┐
│                    Quality Evaluator Skill                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  네이티브 관점 품질 평가                                          │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                                                             │ │
│  │  자연스러움 (Fluency)                             40%      │ │
│  │  ├─ 원어민처럼 자연스러운 흐름                             │ │
│  │  ├─ 어색한 직역 표현 감지                                  │ │
│  │  └─ 관용적 표현 사용                                       │ │
│  │                                                             │ │
│  │  톤/격식 (Tone & Formality)                       30%      │ │
│  │  ├─ 콘텐츠 유형에 맞는 톤                                  │ │
│  │  │   ├─ FAQ: 친근하고 전문적                               │ │
│  │  │   ├─ 법률: 격식체, 정확                                 │ │
│  │  │   └─ UI: 간결, 행동 지향                                │ │
│  │  └─ 로케일별 격식 수준                                     │ │
│  │                                                             │ │
│  │  문화적 적합성 (Cultural Fit)                     30%      │ │
│  │  ├─ 관용구/비유 적절성                                     │ │
│  │  ├─ 문화적 민감성                                          │ │
│  │  └─ 날짜/숫자 형식 현지화                                  │ │
│  │                                                             │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │  후보 비교 (Pairwise Comparison)                           │ │
│  │  ├─ 후보 A vs 후보 B 직접 비교                             │ │
│  │  ├─ 각 측면별 우열 분석                                    │ │
│  │  └─ 최적 후보 선택 및 근거                                 │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**로케일별 품질 기준**:

| 로케일 | 특징 |
|--------|------|
| **en-rUS** | 능동태 선호, 축약형 사용 (you'll, don't), 직접적 스타일 |
| **en-rGB** | 미국보다 약간 격식적, 영국식 철자 (colour, organise) |
| **ja** | 경어 유지 (です/ます), 적절한 조사 사용 |
| **zh-rCN** | 간체자, 격식체, 양사 사용 |
| **de** | 복합어 형성, Sie/du 구분 |

**점수 기준 (0-5점)**:

| 점수 | 판정 | 설명 |
|------|------|------|
| **5점** | Pass | 원어민 수준, 완벽한 톤 |
| **4점** | Pass | 자연스러움, 경미한 스타일 선호도 차이 |
| **3점** | Review | 이해 가능하나 어색한 표현 있음 |
| **2점** | Fail | 번역체 느낌, 톤 불일치 |
| **1점** | Fail | 읽기 어려움, 톤 완전 부적절 |
| **0점** | Fail | 이해 불가 또는 공격적 |

---

## SKILL.md 구조

모든 스킬은 **Hybrid (Markdown + XML)** 형식을 사용합니다:

```markdown
---
name: skill-name
description: 스킬 설명 (언제 사용되는지)
---

## Role
<role>
역할 및 목표 정의
</role>

## Behavior
<behavior>
<chain_of_thought>
점수 전에 평가 과정 설명
</chain_of_thought>

<investigate_before_answering>
추측하지 않고 실제 비교 결과에 기반
</investigate_before_answering>
</behavior>

## Instructions
<instructions>
Step 1: ...
Step 2: ...
</instructions>

## Scoring
<scoring>
5점: 완벽
4점: 경미한 수정
...
</scoring>

## Output Format
<output_format>
JSON 출력 형식 정의
</output_format>

## Constraints
<constraints>
이 스킬에서 평가하지 않는 것
</constraints>
```

---

## 스킬 로드 방법

```python
from src.prompts import PromptTemplateLoader

loader = PromptTemplateLoader()

# 스킬 로드
translator_skill = loader.load_skill("translator")
accuracy_skill = loader.load_skill("accuracy-evaluator")

# 메타데이터 접근
print(translator_skill.metadata["name"])  # "translator"
print(translator_skill.metadata["description"])

# 콘텐츠 접근
print(translator_skill.content)

# 특정 섹션 추출
scoring = accuracy_skill.get_section("Scoring")
```

---

## 평가 흐름

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           평가 워크플로우                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   원문                                                                       │
│     │                                                                        │
│     ▼                                                                        │
│   ┌─────────────┐     ┌─────────────┐                                       │
│   │ Translator  │────▶│Backtranslator│                                      │
│   │   (Opus)    │     │   (Opus)    │                                       │
│   └─────────────┘     └──────┬──────┘                                       │
│         │                    │                                               │
│         │                    ▼                                               │
│         │            ┌──────────────┐                                       │
│         │            │   역번역문    │                                       │
│         │            └──────┬───────┘                                       │
│         │                   │                                                │
│         ▼                   ▼                                                │
│   ┌─────────────────────────────────────────────────────────┐               │
│   │              3개 평가 에이전트 병렬 실행                   │               │
│   │                                                          │               │
│   │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │               │
│   │  │  Accuracy   │ │ Compliance  │ │   Quality   │        │               │
│   │  │  Evaluator  │ │  Evaluator  │ │  Evaluator  │        │               │
│   │  │   (Opus)    │ │   (Opus)    │ │   (Opus)    │        │               │
│   │  └──────┬──────┘ └──────┬──────┘ └──────┬──────┘        │               │
│   │         │               │               │                │               │
│   │         ▼               ▼               ▼                │               │
│   │      [0-5점]         [0-5점]         [0-5점]             │               │
│   │                                                          │               │
│   └─────────────────────────────────────────────────────────┘               │
│                              │                                               │
│                              ▼                                               │
│                    ┌─────────────────┐                                      │
│                    │  Evaluation Gate │                                      │
│                    │   (판정 로직)     │                                      │
│                    └────────┬────────┘                                      │
│                             │                                                │
│              ┌──────────────┼──────────────┐                                │
│              ▼              ▼              ▼                                │
│         ┌────────┐    ┌──────────┐   ┌─────────┐                           │
│         │  PASS  │    │ REGENERATE│   │  FAIL   │                           │
│         │ 발행   │    │  재생성   │   │ 차단    │                           │
│         │ 가능   │    │ (1회)    │   │        │                            │
│         └────────┘    └──────────┘   └─────────┘                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 판정 기준 요약

| 조건 | 판정 | 다음 단계 |
|------|------|-----------|
| 모든 에이전트 = 5점 | **PASS** | 발행 가능 |
| 하나라도 ≤ 2점 | **BLOCK** | 즉시 차단 |
| 하나라도 3-4점 (재시도 가능) | **REGENERATE** | 피드백 반영 재번역 |
| 하나라도 3-4점 (재시도 소진) | **REJECTED** | 거부 (HITL 미구현) |
| 에이전트 간 점수 차이 ≥ 3점 | **REJECTED** | 불일치로 거부 |

---

## 참고 자료

- `src/prompts/README.md` - 프롬프트 템플릿 사용법
- `data/risk_profiles/` - 국가별 리스크 프로파일
